## ----setup, include=FALSE------------------------------------------------
knitr::opts_chunk$set(cache=FALSE)


## ----echo = FALSE--------------------------------------------------------
C <- chol(S <- toeplitz(.9 ^ (0:31))) # Cov.matrix and its root
set.seed(17)
X <- matrix(rnorm(32000), 1000, 32)
Z <- X %*% C  ## ==>  cov(Z) ~=  C'C = S
pZ <- prcomp(Z, tol = 0.1)
screeplot(pZ, type = 'lines', main = '')


## ------------------------------------------------------------------------
C <- chol(S <- matrix(c(1, 0.5, 0.1,
                        0.5, 1, 0.5,
                        0.1, 0.5, 1), 
                      ncol = 3)) 

set.seed(17)
X <- matrix(rnorm(300), 100, 3)
Z <- X %*% C  ## ==>  cov(Z) ~=  C'C = S
pca <- prcomp(Z)


## ------------------------------------------------------------------------
summary(pca)


## ------------------------------------------------------------------------
screeplot(pca, type = 'l')


## ------------------------------------------------------------------------
pca <- prcomp(USArrests, scale = TRUE)


## ------------------------------------------------------------------------
summary(pca)


## ------------------------------------------------------------------------
screeplot(pca, type = 'l')

